<% const rowsPerPage=50 %>
	<!DOCTYPE html>
	<html>

	<head>
		<meta charset="UTF-8" />
		<title>Mysterium Node Data</title>
		<link rel="stylesheet" href="/public/styles.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	</head>

	<body>
		<h1>Mysterium Node Data</h1>
		<form method="get">
			<label for="search">Search:</label>
			<input type="text" id="search" name="search" placeholder="Search anything..." />
			<button type="submit">Submit</button>
		</form>
		<div class="pagination" style="text-align: center; margin-bottom: 15px">
			<button class="page-btn" data-page="1">1</button>

			<% for (let i=startPage; i <=endPage; i++) { %>
				<button class="page-btn <%= i === currentPage ? 'active' : '' %>" data-page="<%= i %>">
					<%= i %>
				</button>
				<% } %>
					<% if (currentPage !==numPages && numPages> 5) { %>
						<button class="page-btn" data-page="<%= numPages %>">
							<%= numPages %>
						</button>
						<% } %>

		</div>
		<script>
			$('button[data-page="290"]').each(function () { // Temporary fix for pagination
				if ($(this).next().data('page') == 290) {
					$(this).remove();
				}
			});
			$('button[data-page="1"]').each(function () { // Temporary fix for pagination
				if ($(this).next().data('page') == 1) {
					$(this).remove();
				}
			});
		</script>
		<table>
			<thead>
				<tr>
					<th id="continent-header">Continent <i class="fas fa-sort"></i></th>
					<th id="country-header">Country <i class="fas fa-sort"></i></th>
					<th id="region-header">Region <i class="fas fa-sort"></i></th>
					<th id="city-header">City <i class="fas fa-sort"></i></th>
					<th id="asn-header">ASN <i class="fas fa-sort"></i></th>
					<th id="isp-header">ISP <i class="fas fa-sort"></i></th>
					<th id="ip-type-header">IP Type <i class="fas fa-sort"></i></th>
					<th id="provider-id-header">Provider ID <i class="fas fa-sort"></i></th>
				</tr>
			</thead>
			<tbody>
				<% data.slice(0, rowsPerPage).forEach(row=> { %>
					<tr>
						<td>
							<%= row.location.continent %>
						</td>
						<td>
							<%= row.location.country %>
						</td>
						<td>
							<%= row.location.region %>
						</td>
						<td>
							<%= row.location.city %>
						</td>
						<td>
							<%= row.asn %>
						</td>
						<td>
							<%= row.isp %>
						</td>
						<td>
							<%= row.ipType %>
						</td>
						<td>
							<%= row.provider_id %>
						</td>
					</tr>
					<% }) %>
			</tbody>
		</table>

		<script>
			const pageButtons = document.querySelectorAll('.page-btn');
			pageButtons.forEach(button => {
				button.addEventListener('click', (event) => {
					event.preventDefault();
					const page = event.target.dataset.page;
					window.location.href = `/?page=${page}`;
				});
			});
		</script>

		<script src="/public/script.js"></script>
	</body>

	</html>